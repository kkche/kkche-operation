
echo 'deb http://downloads-distro.mongodb.org/repo/ubuntu-upstart dist 10gen' | \
sudo tee /etc/apt/sources.list.d/mongodb.list

sudo apt-key adv --keyserver keyserver.ubuntu.com --recv 7F0CEB10

sudo apt-get update && sudo apt-get install mongodb-org

sudo vi /etc/mongodb.conf
auth = true
port = 27017
bind_ip = 127.0.0.1
replSet=<replSet name>

sudo service mongod restart

netstat -tln
sudo lsof -i:27017
tail -f /var/log/mongodb/mongod.log

sudo chkconfig mongod
sudo update-rc.d mongod defaults

mongo
> use admin
> db.addUser("<username>", "<password>")
> db.auth("<username>", "<password>")
> db.system.users.find()
> use <db_name>
> db.addUser("<username>", "<password>")
> show dbs
> use <db_name>
> db.dropDatabase()
> show collections
> db.<collection_name>.drop()
> db.<collection_name>.find().limit(5)
> db.<collection_name>.update({_id:ObjectId("<oid>"), { }...})
> db.<collection_name>.remove({ })
> db.fs.chunks.count()
> db.fs.chunks.findOne()
> db.fs.files.find({_id:ObjectId("<oid>")})
> db.fs.chunks.find({files_id:ObjectId("<oid>")})


# backup and migration
sudo service mongod stop
sudo mongodump --dbpath /var/lib/mongodb --out /var/lib/mongodb.backup
mongorestore /var/lib/mongodb.backup

# Replica Set
mongo
> rs.initiate()
> rs.add('<host name>:<port>')

# Convert a Standalone to a Replica Set
mongod --port <port> --dbpath <dbpath> --replSet <rsname>
